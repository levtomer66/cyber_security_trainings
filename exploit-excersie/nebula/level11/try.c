/******************************************************************************

                            Online C Compiler.
                Code, Compile, Run and Debug C program online.
Write your code in this editor and press "Run" button to compile and execute it.

*******************************************************************************/

#include <stdio.h>
#define CL "Content-Length: "
#include <string.h>
#include <stdlib.h>
int main()
{
    // printf("Typeof: %s", typeof(line + strlen(CL)));
    char line[256];
    int length;
    // fgets(line, sizeof(line), stdin);
    // length = atoi(line + strlen(CL));
    length = 7;
    unsigned int key;
    
    key = length & 0xff;
    char buffer[256] = "getflag";
    // char buffer[256] = "sĩR�5x";
    for (int i = 0; i < strlen(buffer); i++) {
        printf("Before change buffer... key: %u, buffer[%u]: %d, %c\n", key, i, buffer[i], buffer[i]);
        buffer[i] = buffer[i] ^ key;
        // temp ^= key;
        printf("After change buffer... key: %u, buffer[%u]: %d, %c\n", key, i, buffer[i], buffer[i]);
        printf("Before change key... key: %u, buffer[%u]: %d, %c\n", key, i, buffer[i], buffer[i]);
        key -= buffer[i];
        printf("After change key... key: %u, buffer[%u]: %d, %c\n", key, i, buffer[i], buffer[i]);
    }
    printf ("Buffer: %s\n\n", buffer);
    
    char buffer2[256];
    char temp[256];
    strcpy(buffer2, buffer);
    strcpy(temp, buffer2);
    key = length & 0xff;
    printf ("temp: %s\n\n", temp);
    printf ("buffer2: %s\n\n", buffer2);
    for (int i = 0; i < strlen(buffer2); i++) {
        printf("Before change buffer2... key: %u, buffer2[%u]: %d, %c\n", key, i, buffer2[i], buffer2[i]);
        buffer2[i] ^= key;
        printf("After change buffer2... key: %u, buffer2[%u]: %d, %c\n", key, i, buffer2[i], buffer2[i]);
        printf("Before change key... key: %u, buffer2[%u]: %d, %c\n", key, i, buffer2[i], buffer2[i]);
        key -= temp[i];
        printf("After change key... key: %u, buffer2[%u]: %d, %c\n", key, i, buffer2[i], buffer2[i]);
    }
    printf ("Buffer: %s\n\n", buffer2);
    
    
    // printf("buffer[0]: %u\n", buffer[0]^key);
    
    // printf("Length: %d\n", length);
    // printf("Key: %d", key);
    return 0;
}
