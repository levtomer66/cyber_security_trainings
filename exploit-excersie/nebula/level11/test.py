
def enc(buffer):
    key = 1024
    print (key)
    buffer = list(buffer)
    print (list(buffer))
    print ("-" * 40)
    for i in range(len(buffer)):
        buffer[i] = (ord(buffer[i]) ^ key) & 0xFF
        key = ((key - buffer[i]) & 0xffffffff)
    print (list(buffer))
    print (repr("".join([chr(c) for c in buffer])))

def dec(want):
    key = 1024
    print (key)
    want = list(want)
    print (list(want))
    print ("-" * 40)
    res = ['\x00'] * len(want)
    print (res)
    for i in range(len(want)):
        res[i] = (ord(want[i]) ^ key) & 0xFF
        key = ((key - ord(want[i])) & 0xffffffff)
    print (list(res))
    print (repr("".join([chr(c) for c in res])))

enc('g\xfc@\xa66\x8f\xea')
# print ("Content-Length: " + str(len(want)) + "\n" + total)
dec("getflag")
# char buffer[256] = {96, 65477, 65359, 65185, 65037, 64916, 65011};

# [\\x60\\xffc5\\xff4f\\xfea1\\xfe0d\\xfd94\\xfdf3]